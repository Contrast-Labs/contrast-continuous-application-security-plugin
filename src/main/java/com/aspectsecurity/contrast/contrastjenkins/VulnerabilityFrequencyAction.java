package com.aspectsecurity.contrast.contrastjenkins;

import hudson.model.AbstractBuild;
import hudson.model.Action;
import lombok.Getter;
import lombok.Setter;

import java.util.List;
import java.util.Map;

@Getter
@Setter
public class VulnerabilityFrequencyAction implements Action {

    private AbstractBuild<?, ?> build;
    private VulnerabilityTrendResult result;

    public VulnerabilityFrequencyAction(VulnerabilityTrendResult result, AbstractBuild<?, ?> build) {
        this.result = result;
        this.build = build;
    }

    public String getIconFileName() {
        return "/plugin/contrast-continuous-application-security/img/trend_graph.png";
    }

    public String getDisplayName() {
        return "Vulnerability Report";
    }

    public String getUrlName() {
        return "vulnReport";
    }

    public int getBuildNumber() {
        return this.build.getNumber();
    }

    public String getReport() {
        return "Vulnerability Report";
    }

    public Map<String, Integer> getTraceResult() {
        return result.getTraceResult();
    }

    public Map<String, Integer> getSeverityResult() {
        return result.getSeverityResult();
    }

    public List<String> getSeverities() {
        return VulnerabilityTrendHelper.SEVERITIES;
    }

    @Override
    public String toString() {
        return "Build Number # " + build.getNumber() + "<br />" + result.toString();
    }
}